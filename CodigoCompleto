import evaluacionsript
import matplotlib.pyplot as plt
import serial
import numpy as np
import threading
import time
import serial
import time
import struct
import matplotlib.animation as animation
import practicascript
ser = serial.Serial('COM3', 9600)


while True:

     dato=ser.readline().decode('utf-8')
     try:
        dato=float(dato)
     except:
         pass

     if (dato==2): #EVALUACION
       lista= []
       #if (dato==1):
        #    practica()#VERIFICO SI CAMBIAN DE ESTADO EN ARDUINO PARA IR A PRACTICA
       #else:
        #   continue
       print ("Indique el tiempo que desea que dure la evaluacion en MINUTOS  ")
       #ME ESTAN ENTRANDO DATOS DESDE ARDUINO Y NO SE QUE PASA CON ESOS DATOS
       tiempoevaluacion= input()
       tiempoevaluacion=float(tiempoevaluacion)
       tiempoevaluacions= tiempoevaluacion*60
       print("el tiempo de evaluacion ser√° de,",tiempoevaluacion, "minutos")
       start = time.time()
       ttot = 0
       end = 0
       print("Comienza evaluacion")
       while ttot < tiempoevaluacions:
             end = time.time()
             ttot = end - start
             ttot = float(ttot)
             valor = ser.readline().decode('utf-8')
             try:
               valor = float(valor)
               lista.append(valor)
             except:
               pass
       print("El prceso de evaluacion ha finalizado")
       if (dato == 0):
           lista = []
           if (dato == 1):#VERIFICO SI CAMBIAN DE ESTADO EN ARDUINO PARA IR A PRACTICA
               practica()
           else:
               continue
       evaluacionsript.evaluacion(lista,tiempoevaluacion)
       plt.plot(lista)
       plt.show()
       print(lista)


     elif (dato==1): #PRACTICA
         ser.close()
         practicascript.practica()
